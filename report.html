<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>System Report</title>

<style>
body {
    font-family: "Segoe UI", Tahoma, sans-serif;
    background: #f2f4f7;
    margin: 0;
}

/* ===== Layout ===== */
.wrapper {
    display: flex;
    min-height: 100vh;
}

.sidebar {
    width: 240px;
    background: #0d6efd;
    color: #fff;
    padding: 20px;
}

.sidebar h2 {
    text-align: center;
    margin-bottom: 30px;
}

.sidebar a {
    display: block;
    color: #fff;
    text-decoration: none;
    padding: 12px;
    border-radius: 6px;
    margin-bottom: 10px;
}

.sidebar a:hover,
.sidebar a.active {
    background: rgba(255,255,255,0.2);
}

.main {
    flex: 1;
    padding: 25px;
}

.header {
    font-size: 22px;
    margin-bottom: 20px;
}

/* ===== Filter ===== */
.filters {
    background: #fff;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 20px;
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
}

.filters label {
    font-weight: bold;
}

.filters input {
    padding: 6px;
}

/* ===== Tables ===== */
table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 30px;
    background: #fff;
}

th, td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: center;
    font-size: 14px;
}

th {
    background: #0d6efd;
    color: #fff;
}

.status-normal {
    color: #198754;
    font-weight: bold;
}

.status-abnormal {
    color: #dc3545;
    font-weight: bold;
}

/* ===== Buttons ===== */
.buttons {
    margin-bottom: 20px;
}

button {
    padding: 10px 18px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
}

.print-btn {
    background: #6c757d;
    color: #fff;
}

/* ===== Print ===== */
@media print {
    body {
        background: #fff;
    }

    .sidebar,
    .filters,
    .buttons {
        display: none;
    }

    .main {
        padding: 0;
    }

    table {
        font-size: 12px;
    }
}
</style>
</head>

<body>
 
<div class="wrapper">

    <!-- Sidebar -->
    <div class="sidebar">
        <h2>Office System</h2>
        <a href="index.html">üè† Dashboard</a>
        <a href="temperature.html">üå° Temperature Control</a>
        <a href="visitor.html">üõÇ Visitor Log</a>
        <a href="inventory.html">üìÅ Inventory</a>
        <a href="report.html">üñ® Reports</a>
        <a href="staff.html">üë• Staff</a>
         <a href="operationrule.html" class="active">üìú Operation Rules</a>
        <a href="quotation.html">üßæ Quotation</a>
        <a href="invoice.html">üßæ Invoice</a>
    </div>
    <!-- Main Content -->
    <div class="main">
        <div class="header">Dashboard ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö</div>
    <!-- Main -->
    <div class="main">
        <div class="header">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (Report)</div>

        <!-- Filters -->
        <div class="filters">
            <div>
                <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label><br>
                <input type="date" id="startDate">
            </div>
            <div>
                <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label><br>
                <input type="date" id="endDate">
            </div>
            <div style="align-self:flex-end;">
                <button onclick="loadReport()">‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
            </div>
        </div>

        <div class="buttons">
            <button class="print-btn" onclick="window.print()">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
        </div>

        <!-- Temperature Report -->
        <h3>üå° ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥</h3>
        <table id="tempTable">
            <thead>
                <tr>
                    <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                    <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                    <th>‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ (¬∞C)</th>
                    <th>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô (%RH)</th>
                    <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <!-- Visitor Report -->
        <h3>üõÇ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‚Äì‡∏≠‡∏≠‡∏Å</h3>
        <table id="visitorTable">
            <thead>
                <tr>
                    <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                    <th>‡∏ä‡∏∑‡πà‡∏≠</th>
                    <th>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                    <th>‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏£‡∏ñ</th>
                    <th>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤</th>
                    <th>‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏≠‡∏Å</th>
                    <th>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

    </div>
</div>

<script>
const tempLogs = JSON.parse(localStorage.getItem("temperatureLogs")) || [];
const visitorLogs = JSON.parse(localStorage.getItem("visitorLogs")) || [];

function inRange(date, start, end) {
    if (!start && !end) return true;
    if (start && date < start) return false;
    if (end && date > end) return false;
    return true;
}

function loadReport() {
    const start = document.getElementById("startDate").value;
    const end = document.getElementById("endDate").value;

    /* ===== Temperature ===== */
    const tempBody = document.querySelector("#tempTable tbody");
    tempBody.innerHTML = "";

    tempLogs
        .filter(t => inRange(t.date, start, end))
        .forEach(t => {
            tempBody.innerHTML += `
                <tr>
                    <td>${t.date}</td>
                    <td>${t.time}</td>
                    <td>${t.temp}</td>
                    <td>${t.humidity}</td>
                    <td class="${t.status === '‡∏õ‡∏Å‡∏ï‡∏¥' ? 'status-normal' : 'status-abnormal'}">
                        ${t.status}
                    </td>
                </tr>
            `;
        });

    /* ===== Visitor ===== */
    const visitorBody = document.querySelector("#visitorTable tbody");
    visitorBody.innerHTML = "";

    visitorLogs
        .filter(v => inRange(v.date, start, end))
        .forEach(v => {
            visitorBody.innerHTML += `
                <tr>
                    <td>${v.date}</td>
                    <td>${v.firstName}</td>
                    <td>${v.lastName}</td>
                    <td>${v.carPlate}</td>
                    <td>${v.timeIn}</td>
                    <td>${v.timeOut}</td>
                    <td>${v.purpose}</td>
                </tr>
            `;
        });
}

/* ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ */
loadReport();
</script>

</body>
</html>
