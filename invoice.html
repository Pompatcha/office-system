<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Invoice| Siam10 / FAOS</title>

<style>
body {
  font-family:"Segoe UI",Tahoma,sans-serif;
  background:#f2f4f7;
  padding:20px;
}
.container {
  max-width:1100px;
  background:#fff;
  margin:auto;
  padding:30px;
}
.flex {
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
}
hr { margin:20px 0; }

/* ===== Company ===== */
.company-box {
  display:flex;
  align-items:center;
  gap:15px;
  text-align:right;
}
.company-logo {
  height:70px;
  max-width:140px;
  object-fit:contain;
}
.company-info {
  font-size:14px;
  line-height:1.5;
}

/* ===== Table ===== */
table {
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
}
th,td {
  border:1px solid #ccc;
  padding:8px;
  text-align:center;
}
th {
  background:#0d6efd;
  color:#fff;
}
.summary td {
  border:none;
  padding:6px;
}
input, textarea, select {
  width:100%;
  padding:6px;
  box-sizing:border-box;
}
button {
  padding:10px 16px;
  margin-top:15px;
  margin-right:8px;
}

/* ===== Signature ===== */
canvas {
  border:1px solid #999;
}

/* ===== Print ===== */
@media print {
  button { display:none; }
  body { background:#fff; }
  .container { box-shadow:none; padding:10px; }
  .company-logo { height:60px; }
}
.top-nav {
  display: flex;
  justify-content: flex-end;
  margin-bottom: 10px;
}

.back-btn {
  background: #6c757d;
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 8px 14px;
  cursor: pointer;
  text-decoration: none;
  font-size: 14px;
}

.back-btn:hover {
  background: #5a6268;
}
</style>
</head>

<body>
<div class="container">
  <div class="top-nav">
  <a href="index.html" class="back-btn">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö Dashboard</a>
</div>

<!-- ===== Header ===== -->
<div class="flex">
  <div>
    <h2 style="margin:0;">Invoice</h2>
    <b>Quote No:</b> <span id="quoteNo"></span><br>
    <b>Date:</b> <input type="date" id="quoteDate">
  </div>

  <div class="company-box">
    <img src="assets/logo.png" class="company-logo" alt="SIAM10 FAOS Logo">
    <div class="company-info">
      <b>Siam10 / FAOS</b><br>
      333/253 ‡∏ñ‡∏ô‡∏ô‡∏â‡∏•‡∏≠‡∏á‡∏Å‡∏£‡∏∏‡∏á<br>
      ‡πÅ‡∏Ç‡∏ß‡∏á‡∏•‡∏≥‡∏õ‡∏≤‡∏ó‡∏¥‡∏ß ‡πÄ‡∏Ç‡∏ï‡∏•‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏ö‡∏±‡∏á<br>
      ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10520<br>
      www.faos.asia | Tel: +66 89 693 1668
    </div>
  </div>
</div>

<hr>

<!-- ===== Customer ===== -->
<h4>BILLED TO</h4>
<input id="customer" placeholder="Customer Name">
<input id="address" placeholder="Customer Address">
<input id="phone" placeholder="Phone / Email">

<h4 style="margin-top:20px;">PAYMENT TYPE</h4>
<select id="paymentType">
  <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô --</option>
  <option value="‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</option>
  <option value="‡∏ù‡∏≤‡∏Å‡∏Ç‡∏≤‡∏¢">‡∏ù‡∏≤‡∏Å‡∏Ç‡∏≤‡∏¢</option>
</select>

<!-- ===== Items ===== -->
<table id="items">
<thead>
<tr>
  <th style="width:50px;">#</th>
  <th>DESCRIPTION</th>
  <th style="width:120px;">UNIT COST</th>
  <th style="width:100px;">QTY</th>
  <th style="width:140px;">AMOUNT</th>
</tr>
</thead>
<tbody></tbody>
</table>

<button onclick="addRow()">‚ûï Add Item</button>

<!-- ===== Summary ===== -->
<table class="summary">
<tr>
  <td style="text-align:right;">SUBTOTAL</td>
  <td style="text-align:right;" id="sub">0.00</td>
</tr>
<tr>
  <td style="text-align:right;">DISCOUNT</td>
  <td style="text-align:right;">
    <input type="number" id="discount" value="0" oninput="calcTotal()">
  </td>
</tr>
<tr>
  <td style="text-align:right;">TAX 5%</td>
  <td style="text-align:right;" id="tax">0.00</td>
</tr>
<tr>
  <td style="text-align:right;"><b>TOTAL</b></td>
  <td style="text-align:right;"><b id="total">0.00</b></td>
</tr>
</table>

<!-- ===== Note ===== -->
<h4>NOTE / REMARK</h4>
<textarea id="note" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ / ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô"></textarea>

<hr>

<!-- ===== Approval ===== -->
<h4>APPROVAL</h4>
<table style="border:none;">
<tr>
<td>
‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢<br>
<canvas id="signSales" width="250" height="80"></canvas><br>
<input placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <input type="date">
</td>

<td>
‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô<br>
<canvas id="signManager" width="250" height="80"></canvas><br>
<input placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <input type="date">
</td>

<td>
‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥<br>
<canvas id="signApprove" width="250" height="80"></canvas><br>
<input placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <input type="date">
</td>
</tr>
</table>

<hr>

<button onclick="saveQuotation()">üíæ Save Quotation</button>
<button onclick="createInvoice()">‚û° Create Invoice</button>
<button onclick="window.print()">üñ® Print</button>

</div>

<script>
/* ===== Quote No Auto ===== */
function generateQuoteNo(){
  const d=new Date();
  const date=d.getFullYear()+String(d.getMonth()+1).padStart(2,'0')+String(d.getDate()).padStart(2,'0');
  const key="QT_COUNT_"+date;
  let n=(parseInt(localStorage.getItem(key))||0)+1;
  localStorage.setItem(key,n);
  return `QT-${date}-${String(n).padStart(3,'0')}`;
}
quoteNo.innerText=generateQuoteNo();
quoteDate.valueAsDate=new Date();

/* ===== Items with Auto No ===== */
let items=[];
const body=document.querySelector("#items tbody");

function addRow(){
  const i=items.length;
  items.push({desc:"",cost:0,qty:0});
  body.innerHTML+=`
  <tr>
    <td>${i+1}</td>
    <td><input oninput="update(${i})"></td>
    <td><input type="number" oninput="update(${i})"></td>
    <td><input type="number" oninput="update(${i})"></td>
    <td id="amt${i}">0.00</td>
  </tr>`;
}

function update(i){
  const r=body.rows[i].querySelectorAll("input");
  items[i]={desc:r[0].value,cost:+r[1].value||0,qty:+r[2].value||0};
  document.getElementById("amt"+i).innerText=(items[i].cost*items[i].qty).toFixed(2);
  calcTotal();
}

function calcTotal(){
  const sub=items.reduce((s,x)=>s+x.cost*x.qty,0);
  const dis=+discount.value||0;
  const tax=(sub-dis)*0.05;
  document.getElementById("sub").innerText=sub.toFixed(2);
  document.getElementById("tax").innerText=tax.toFixed(2);
  document.getElementById("total").innerText=(sub-dis+tax).toFixed(2);
}

/* ===== Save ===== */
function saveQuotation(){
  const data=JSON.parse(localStorage.getItem("quotations")||"[]");
  const q={
    id:quoteNo.innerText,
    date:quoteDate.value,
    customer:customer.value,
    address:address.value,
    phone:phone.value,
    paymentType:paymentType.value,
    items,
    subtotal:sub.innerText,
    discount:discount.value,
    tax:tax.innerText,
    total:total.innerText,
    note:note.value
  };
  data.push(q);
  localStorage.setItem("quotations",JSON.stringify(data));
  localStorage.setItem("lastQuotation",q.id);
  alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Quotation ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
}

function createInvoice(){
  saveQuotation();
  location.href="invoice.html";
}

/* ===== Signature ===== */
function enableSign(id){
  const c=document.getElementById(id);
  const ctx=c.getContext("2d");
  let draw=false;
  c.onmousedown=()=>draw=true;
  c.onmouseup=()=>{draw=false;ctx.beginPath();};
  c.onmousemove=e=>{
    if(!draw)return;
    ctx.lineWidth=2;
    ctx.lineCap="round";
    ctx.lineTo(e.offsetX,e.offsetY);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(e.offsetX,e.offsetY);
  };
}
["signSales","signManager","signApprove"].forEach(enableSign);

addRow();
</script>

</body>
</html>
